!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(require("underscore")):"function"==typeof define&&define.amd?define(["underscore"],r):"object"==typeof exports?exports.kmath=r(require("underscore")):t.kmath=r(t._)}(self,(function(t){return(()=>{"use strict";var r={45:(t,r,e)=>{t.exports={number:e(414),vector:e(670),point:e(368),line:e(35),ray:e(450)}},35:(t,r,e)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.distanceToPoint=function(t,r){return o.distanceToLine(r,t)},r.equal=function(t,r,e){var n=u.subtract(t[1],t[0]),a=u.subtract(r[1],r[0]);if(!u.collinear(n,a,e))return!1;if(o.equal(t[0],r[0]))return!0;var i=u.subtract(r[0],t[0]);return u.collinear(n,i,e)},r.midpoint=function(t){return[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2]},r.reflectPoint=function(t,r){return o.reflectOverLine(r,t)};var o=i(e(368)),u=i(e(670));function a(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,e=new WeakMap;return(a=function(t){return t?e:r})(t)}function i(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!==n(t)&&"function"!=typeof t)return{default:t};var e=a(r);if(e&&e.has(t))return e.get(t);var o={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if("default"!==i&&Object.prototype.hasOwnProperty.call(t,i)){var f=u?Object.getOwnPropertyDescriptor(t,i):null;f&&(f.get||f.set)?Object.defineProperty(o,i,f):o[i]=t[i]}return o.default=t,e&&e.set(t,o),o}},414:(t,r,e)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.EPSILON=r.DEFAULT_TOLERANCE=void 0,r.ceilTo=function(t,r){return Math.ceil(t/r)*r},r.equal=a,r.floorTo=function(t,r){return Math.floor(t/r)*r},r.is=function(t){return o.default.isNumber(t)&&!o.default.isNaN(t)},r.isInteger=function(t,r){return a(Math.round(t),t,r)},r.round=function(t,r){var e=Math.pow(10,r);return Math.round(t*e)/e},r.roundTo=function(t,r){return Math.round(t/r)*r},r.sign=function(t,r){return a(t,0,r)?0:Math.abs(t)/t},r.toFraction=function(t){for(var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,n=[1,0],o=[0,1],i=Math.floor(t),f=t-i;o[0]<=e;){if(a(n[0]/o[0],t,r))return[n[0],o[0]];n=[i*n[0]+n[1],n[0]],o=[i*o[0]+o[1],o[0]],f=1/f-(i=Math.floor(1/f))}return[t,1]};var n,o=(n=e(38))&&n.__esModule?n:{default:n};r.DEFAULT_TOLERANCE=1e-9;var u=Math.pow(2,-42);function a(t,r,e){return null==t||null==r?t===r:t===r||(null==e&&(e=1e-9),Math.abs(t-r)<e)}r.EPSILON=u},368:(t,r,e)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.ceilTo=r.cartFromPolarRad=r.cartFromPolarDeg=r.addVectors=r.addVector=void 0,r.compare=function(t,r,e){if(t.length!==r.length)return t.length-r.length;for(var n=0;n<t.length;n++)if(!a.equal(t[n],r[n],e))return t[n]-r[n];return 0},r.distanceToLine=function(t,r){var e=u.subtract(r[1],r[0]),n=u.subtract(t,r[0]),o=u.projection(n,e),a=u.subtract(o,n);return u.length(a)},r.distanceToPoint=function(t,r){return u.length(u.subtract(t,r))},r.polarRadFromCart=r.polarDegFromCart=r.is=r.floorTo=r.equal=void 0,r.reflectOverLine=function(t,r){var e=u.subtract(r[1],r[0]),n=u.subtract(t,r[0]),o=u.projection(n,e),a=u.subtract(u.scale(o,2),n);return u.add(r[0],a)},r.rotateDeg=function(t,r,e){return void 0===e?u.rotateDeg(t,r):u.add(e,u.rotateDeg(u.subtract(t,e),r))},r.rotateRad=function(t,r,e){return void 0===e?u.rotateRad(t,r):u.add(e,u.rotateRad(u.subtract(t,e),r))},r.subtractVector=r.roundTo=r.round=void 0,(o=e(38))&&o.__esModule;var o,u=f(e(670)),a=f(e(414));function i(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,e=new WeakMap;return(i=function(t){return t?e:r})(t)}function f(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!==n(t)&&"function"!=typeof t)return{default:t};var e=i(r);if(e&&e.has(t))return e.get(t);var o={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var f=u?Object.getOwnPropertyDescriptor(t,a):null;f&&(f.get||f.set)?Object.defineProperty(o,a,f):o[a]=t[a]}return o.default=t,e&&e.set(t,o),o}var c=u.is;r.is=c;var l=u.add;r.addVector=l;var p=u.add;r.addVectors=p;var d=u.subtract;r.subtractVector=d;var s=u.equal;r.equal=s;var y=u.polarRadFromCart;r.polarRadFromCart=y;var b=u.polarDegFromCart;r.polarDegFromCart=b;var v=u.cartFromPolarRad;r.cartFromPolarRad=v;var m=u.cartFromPolarDeg;r.cartFromPolarDeg=m;var g=u.round;r.round=g;var M=u.roundTo;r.roundTo=M;var O=u.floorTo;r.floorTo=O;var h=u.ceilTo;r.ceilTo=h},450:(t,r,e)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.equal=function(t,r,e){var n=o.subtract(t[1],t[0]),a=o.subtract(r[1],r[0]),i=u.equal(t[0],r[0]),f=o.codirectional(n,a,e);return i&&f};var o=i(e(670)),u=i(e(368));function a(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,e=new WeakMap;return(a=function(t){return t?e:r})(t)}function i(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!==n(t)&&"function"!=typeof t)return{default:t};var e=a(r);if(e&&e.has(t))return e.get(t);var o={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if("default"!==i&&Object.prototype.hasOwnProperty.call(t,i)){var f=u?Object.getOwnPropertyDescriptor(t,i):null;f&&(f.get||f.set)?Object.defineProperty(o,i,f):o[i]=t[i]}return o.default=t,e&&e.set(t,o),o}},670:(t,r,e)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.add=function(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];var n=u.default.toArray(arguments),o=u.default.zip.apply(u.default,n);return o.map(f)},r.angleDeg=function(t,r){return 180*h(t,r)/Math.PI},r.angleRad=h,r.cartFromPolarDeg=O,r.cartFromPolarRad=M,r.ceilTo=function(t,r){return t.map((function(t,e){return a.ceilTo(t,r[e]||r)}))},r.codirectional=v,r.collinear=function(t,r,e){return v(t,r,e)||v(t,s(r),e)},r.dot=d,r.equal=b,r.floorTo=function(t,r){return t.map((function(t,e){return a.floorTo(t,r[e]||r)}))},r.is=function(t,r){return!!u.default.isArray(t)&&((void 0===r||t.length===r)&&t.every(a.is))},r.length=p,r.negate=s,r.normalize=l,r.polarDegFromCart=g,r.polarRadFromCart=m,r.projection=function(t,r){return y(r,d(t,r)/d(r,r))},r.rotateDeg=function(t,r){var e=g(t),n=e[1]+r;return O(e[0],n)},r.rotateRad=function(t,r){var e=m(t),n=e[1]+r;return M(e[0],n)},r.round=function(t,r){return t.map((function(t,e){return a.round(t,r[e]||r)}))},r.roundTo=function(t,r){return t.map((function(t,e){return a.roundTo(t,r[e]||r)}))},r.scale=y,r.subtract=function(t,r){return u.default.zip(t,r).map((function(t){return t[0]-t[1]}))};var o,u=(o=e(38))&&o.__esModule?o:{default:o},a=function(t,r){if(t&&t.__esModule)return t;if(null===t||"object"!==n(t)&&"function"!=typeof t)return{default:t};var e=i(r);if(e&&e.has(t))return e.get(t);var o={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var f=u?Object.getOwnPropertyDescriptor(t,a):null;f&&(f.get||f.set)?Object.defineProperty(o,a,f):o[a]=t[a]}return o.default=t,e&&e.set(t,o),o}(e(414));function i(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,e=new WeakMap;return(i=function(t){return t?e:r})(t)}function f(t){return t.reduce((function(t,r){return t+r}),0)}function c(t){return t.reduce((function(t,r){return t*r}),1)}function l(t){return y(t,1/p(t))}function p(t){return Math.sqrt(d(t,t))}function d(t,r){var e=u.default.toArray(arguments),n=u.default.zip.apply(u.default,e),o=n.map(c);return f(o)}function s(t){return t.map((function(t){return-t}))}function y(t,r){return t.map((function(t){return t*r}))}function b(t,r,e){return u.default.zip(t,r).every((function(t){return a.equal(t[0],t[1],e)}))}function v(t,r,e){return!(!a.equal(p(t),0,e)&&!a.equal(p(r),0,e))||b(t=l(t),r=l(r),e)}function m(t){var r=p(t),e=Math.atan2(t[1],t[0]);return e<0&&(e+=2*Math.PI),[r,e]}function g(t){var r=m(t);return[r[0],180*r[1]/Math.PI]}function M(t,r){return u.default.isUndefined(r)&&(r=t[1],t=t[0]),[t*Math.cos(r),t*Math.sin(r)]}function O(t,r){return u.default.isUndefined(r)&&(r=t[1],t=t[0]),M(t,r*Math.PI/180)}function h(t,r){return Math.acos(d(t,r)/(p(t)*p(r)))}},38:r=>{r.exports=t}},e={};return function t(n){var o=e[n];if(void 0!==o)return o.exports;var u=e[n]={exports:{}};return r[n](u,u.exports,t),u.exports}(45)})()}));